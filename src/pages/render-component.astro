---
export const prerender = false;

import Button from '../components/examples/Button.astro';
import InteractiveButton from '../components/examples/InteractiveButton.astro';
import ReactCounter from '../components/examples/ReactCounter.tsx';

const componentMap = {
  Button,
  InteractiveButton,
  ReactCounter,
};

const url = new URL(Astro.request.url);
const componentName = url.searchParams.get('component');
const Component = componentMap[componentName as keyof typeof componentMap];

if (!Component) {
  return new Response('Component not found', { status: 404 });
}

const props: Record<string, any> = {};
for (const [key, value] of url.searchParams.entries()) {
  if (key !== 'component') {
    if (value === 'true' || value === 'false') {
      props[key] = value === 'true';
    } else if (!isNaN(Number(value))) {
      props[key] = Number(value);
    } else {
      props[key] = value;
    }
  }
}
---

<Component {...props} />